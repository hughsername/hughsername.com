---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getHighlighter } from '../utils/shikiHighlighter';
import DeviceMock from '../components/DeviceMock';
import GraphPaper from '../components/GraphPaper';
import CrouwelCalendar from '../components/CrouwelCalendar';
import BlogPost from '../components/BlogPost';
import CodeBlock from '../components/CodeBlock';
import { getImage } from 'astro:assets';
import mountainsHero from '../assets/mountains-hero.jpg';

const optimizedImage = await getImage({
  src: mountainsHero,
  width: 1000,
  height: 700,
  format: 'webp',
  quality: 85
});

// Pre-render the syntax highlighted code
const highlighter = await getHighlighter();

// Dark theme code
const darkCode = highlighter.codeToHtml(`// Calendar animation configuration
const config = {
  monthTransition: {
    duration: 800,
    easing: 'cubic-bezier(0.4, 0, 0.2, 1)',
    stagger: 50
  },
  letterSpacing: {
    default: '0.02em',
    expanded: '0.12em'
  },
  colors: {
    primary: 'rgb(82, 138, 255)',
    secondary: 'rgba(82, 138, 255, 0.8)',
    background: 'rgba(16, 20, 48, 0.95)'
  },
  grid: {
    size: 35,
    lineWidth: 1,
    opacity: 0.15
  }
}`, {
  lang: 'javascript',
  theme: 'github-dark'
});

// Light theme code
const lightCode = highlighter.codeToHtml(`// Example of light variant usage
const lightTheme = {
  colors: {
    primary: 'rgb(41, 69, 128)',
    secondary: 'rgba(41, 69, 128, 0.8)',
    background: 'rgba(255, 255, 255, 0.7)'
  },
  effects: {
    blur: '8px',
    glow: '0 0 48px -4px rgba(82, 138, 255, 0.1)'
  }
}`, {
  lang: 'javascript',
  theme: 'github-light'
});
---

<BaseLayout title="Device Mock Test">
  <div style="position: relative; width: 100%; min-height: 150vh;">
    <div style="max-width: 1400px; margin: 0 auto; padding: 2rem;">
      <div style="margin-bottom: 4rem;">
        <DeviceMock client:load imageSrc={optimizedImage.src}>
          <CrouwelCalendar client:load variant="dark" />
        </DeviceMock>
      </div>
      <div style="display: grid; grid-template-columns: 490px 1fr; gap: 4rem;">
        <div style="position: relative; margin-left: -0.7rem;">
          <CrouwelCalendar client:load variant="light" />
        </div>
        <div style="position: relative;">
          <BlogPost client:load>
            {/* Dark variant in device mock */}
            <CodeBlock
              client:load
              language="javascript"
              variant="dark"
              html={darkCode} />
            
            {/* Light variant example */}
            <CodeBlock
              client:load
              language="javascript"
              variant="light"
              html={lightCode} />
          </BlogPost>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<style>
  /* Optional: Add some perspective for a more 3D feel */
  div {
    perspective: 1000px;
  }
</style>
